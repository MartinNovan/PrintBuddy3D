<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:PrintBuddy3D.ViewModels.Pages"
             xmlns:material="using:Material.Icons.Avalonia"
             xmlns:controls="clr-namespace:PrintBuddy3D.Controls"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="PrintBuddy3D.Views.Pages.PrinterControlView"
             x:DataType="vm:PrinterControlViewModel">
    <Grid RowDefinitions="Auto, *">
        <Grid ColumnDefinitions="Auto,*,Auto">
            <Button Classes="Basic" Grid.Column="0" Command="{Binding BackCommand}">
                <material:MaterialIcon Kind="ArrowBack"/>
            </Button>
            <StackPanel Grid.Column="1"
                Orientation="Horizontal"
                HorizontalAlignment="Left"
                Spacing="5">
                <Button
                    ToolTip.Tip="Open Layout"
                    Classes="Basic"
                    Width="30"
                    Height="30"
                    IsVisible="{Binding !IsWebModeEnabled}"
                    Command="{Binding OpenLayoutCommand}">
                    <material:MaterialIcon
                        Width="20"
                        Height="20"
                        Kind="File"/>
                </Button>
                <Button
                    ToolTip.Tip="Save layout as"
                    Classes="Basic"
                    Width="30"
                    Height="30"
                    IsVisible="{Binding !IsWebModeEnabled}"
                    x:Name="FileSaveLayout"
                    Command="{Binding SaveLayoutCommand}">
                    <material:MaterialIcon
                        Width="20"
                        Height="20"
                        Kind="ContentSave"/>
                </Button>
                <Button
                    ToolTip.Tip="Reset to default layout"
                    Classes="Basic"
                    Width="30"
                    Height="30"
                    IsVisible="{Binding !IsWebModeEnabled}"
                    x:Name="ResetLayout"
                    Command="{Binding ResetLayoutCommand}">
                    <material:MaterialIcon
                        Width="20"
                        Height="20"
                        Kind="Reload"/>
                </Button>
            </StackPanel>
            <StackPanel Grid.Column="2" Orientation="Horizontal">
                <Button Classes="Basic" Foreground="Red" BorderThickness="2" BorderBrush="Red" Margin="5" Command="{Binding EmergencyStopCommand}">
                    <StackPanel Orientation="Horizontal">
                        <material:MaterialIcon Kind="Alert"/>
                        <Label Foreground="Red" Content="Emergency stop"/>
                    </StackPanel>
                </Button> 
                <StackPanel Grid.Column="2"  Orientation="Horizontal" HorizontalAlignment="Right" IsVisible="{Binding !IsWebModeSupported}">
                    <Label Content="Port:" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    <ComboBox ItemsSource="{Binding Ports}" SelectedItem="{Binding SelectedPort, Mode=TwoWay}" />
                    <Label Content="Baudrate:" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    <ComboBox ItemsSource="{Binding Baudrates}" SelectedItem="{Binding SelectedBaudrate, Mode=TwoWay}" />
                </StackPanel>
                <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right" IsVisible="{Binding IsWebModeSupported}">
                    <Label Content="Web mode:"  HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    <ToggleSwitch Command="{Binding SwitchModesCommand}" IsChecked="False"/>
                </StackPanel>
            </StackPanel>
        </Grid>
        <Grid Grid.Row="1" IsVisible="{Binding !IsWebModeEnabled}" >
            <DockControl Layout="{Binding Layout}" Margin="4" />
        </Grid>
        <Grid Grid.Row="1" IsVisible="{Binding IsWebModeEnabled}">
            <OnPlatform>
                <OnPlatform.Windows>
                    <WebView Url="{Binding Printer.FullAddress}"/>
                </OnPlatform.Windows>
                <OnPlatform.Linux>
                    <!--Use custom made webview for linux, because none of the nuget packages works-->
                    <controls:GtkWebView Url="{Binding Printer.FullAddress}"/>
                </OnPlatform.Linux>
            </OnPlatform>
            <Label Content="{Binding ErrorMessage}"/>
        </Grid>
    </Grid>
</UserControl>
